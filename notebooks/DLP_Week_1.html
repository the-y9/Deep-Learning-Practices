
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Week 1 &#8212; Deep Learning Practices</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- So that users can add custom icons -->
  <script src="../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'notebooks/DLP_Week_1';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Week 2" href="DLP_Week_2.html" />
    <link rel="prev" title="Deep-Learning-Practices Notes" href="../README.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../README.html">
  
  
  
  
  
  
    <p class="title logo__title">Deep Learning Practices</p>
  
</a></div>
        <div class="sidebar-primary-item">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../README.html">
                    Deep-Learning-Practices Notes
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Week 1</a></li>
<li class="toctree-l1"><a class="reference internal" href="DLP_Week_2.html">Week 2</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/the-y9/Deep-Learning-Practices" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/the-y9/Deep-Learning-Practices/issues/new?title=Issue%20on%20page%20%2Fnotebooks/DLP_Week_1.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/notebooks/DLP_Week_1.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button>


<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>

</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Week 1</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="week-1">
<h1>Week 1<a class="headerlink" href="#week-1" title="Link to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">pip</span> show datasets || pip install datasets;
<span class="o">%</span><span class="k">pip</span> show transformers || pip install transformers;
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Yellow">WARNING: Package(s) not found: datasets</span>

</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Collecting datasets
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Downloading datasets-3.2.0-py3-none-any.whl.metadata (20 kB)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Collecting filelock (from datasets)
  Downloading filelock-3.17.0-py3-none-any.whl.metadata (2.9 kB)
Requirement already satisfied: numpy&gt;=1.17 in /opt/hostedtoolcache/Python/3.13.1/x64/lib/python3.13/site-packages (from datasets) (2.2.2)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Collecting pyarrow&gt;=15.0.0 (from datasets)
  Downloading pyarrow-19.0.0-cp313-cp313-manylinux_2_28_x86_64.whl.metadata (3.3 kB)
Collecting dill&lt;0.3.9,&gt;=0.3.0 (from datasets)
  Downloading dill-0.3.8-py3-none-any.whl.metadata (10 kB)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Requirement already satisfied: pandas in /opt/hostedtoolcache/Python/3.13.1/x64/lib/python3.13/site-packages (from datasets) (2.2.3)
Requirement already satisfied: requests&gt;=2.32.2 in /opt/hostedtoolcache/Python/3.13.1/x64/lib/python3.13/site-packages (from datasets) (2.32.3)
Collecting tqdm&gt;=4.66.3 (from datasets)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Downloading tqdm-4.67.1-py3-none-any.whl.metadata (57 kB)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Collecting xxhash (from datasets)
  Downloading xxhash-3.5.0-cp313-cp313-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (12 kB)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Collecting multiprocess&lt;0.70.17 (from datasets)
  Downloading multiprocess-0.70.16-py312-none-any.whl.metadata (7.2 kB)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Collecting fsspec&lt;=2024.9.0,&gt;=2023.1.0 (from fsspec[http]&lt;=2024.9.0,&gt;=2023.1.0-&gt;datasets)
  Downloading fsspec-2024.9.0-py3-none-any.whl.metadata (11 kB)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Collecting aiohttp (from datasets)
  Downloading aiohttp-3.11.12-cp313-cp313-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (7.7 kB)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Collecting huggingface-hub&gt;=0.23.0 (from datasets)
  Downloading huggingface_hub-0.28.1-py3-none-any.whl.metadata (13 kB)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Requirement already satisfied: packaging in /opt/hostedtoolcache/Python/3.13.1/x64/lib/python3.13/site-packages (from datasets) (24.2)
Requirement already satisfied: pyyaml&gt;=5.1 in /opt/hostedtoolcache/Python/3.13.1/x64/lib/python3.13/site-packages (from datasets) (6.0.2)
Collecting aiohappyeyeballs&gt;=2.3.0 (from aiohttp-&gt;datasets)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Downloading aiohappyeyeballs-2.4.4-py3-none-any.whl.metadata (6.1 kB)
Collecting aiosignal&gt;=1.1.2 (from aiohttp-&gt;datasets)
  Downloading aiosignal-1.3.2-py2.py3-none-any.whl.metadata (3.8 kB)
Requirement already satisfied: attrs&gt;=17.3.0 in /opt/hostedtoolcache/Python/3.13.1/x64/lib/python3.13/site-packages (from aiohttp-&gt;datasets) (25.1.0)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Collecting frozenlist&gt;=1.1.1 (from aiohttp-&gt;datasets)
  Downloading frozenlist-1.5.0-cp313-cp313-manylinux_2_5_x86_64.manylinux1_x86_64.manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (13 kB)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Collecting multidict&lt;7.0,&gt;=4.5 (from aiohttp-&gt;datasets)
  Downloading multidict-6.1.0-cp313-cp313-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (5.0 kB)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Collecting propcache&gt;=0.2.0 (from aiohttp-&gt;datasets)
  Downloading propcache-0.2.1-cp313-cp313-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (9.2 kB)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Collecting yarl&lt;2.0,&gt;=1.17.0 (from aiohttp-&gt;datasets)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Downloading yarl-1.18.3-cp313-cp313-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (69 kB)
Requirement already satisfied: typing-extensions&gt;=3.7.4.3 in /opt/hostedtoolcache/Python/3.13.1/x64/lib/python3.13/site-packages (from huggingface-hub&gt;=0.23.0-&gt;datasets) (4.12.2)
Requirement already satisfied: charset-normalizer&lt;4,&gt;=2 in /opt/hostedtoolcache/Python/3.13.1/x64/lib/python3.13/site-packages (from requests&gt;=2.32.2-&gt;datasets) (3.4.1)
Requirement already satisfied: idna&lt;4,&gt;=2.5 in /opt/hostedtoolcache/Python/3.13.1/x64/lib/python3.13/site-packages (from requests&gt;=2.32.2-&gt;datasets) (3.10)
Requirement already satisfied: urllib3&lt;3,&gt;=1.21.1 in /opt/hostedtoolcache/Python/3.13.1/x64/lib/python3.13/site-packages (from requests&gt;=2.32.2-&gt;datasets) (2.3.0)
Requirement already satisfied: certifi&gt;=2017.4.17 in /opt/hostedtoolcache/Python/3.13.1/x64/lib/python3.13/site-packages (from requests&gt;=2.32.2-&gt;datasets) (2025.1.31)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Requirement already satisfied: python-dateutil&gt;=2.8.2 in /opt/hostedtoolcache/Python/3.13.1/x64/lib/python3.13/site-packages (from pandas-&gt;datasets) (2.9.0.post0)
Requirement already satisfied: pytz&gt;=2020.1 in /opt/hostedtoolcache/Python/3.13.1/x64/lib/python3.13/site-packages (from pandas-&gt;datasets) (2025.1)
Requirement already satisfied: tzdata&gt;=2022.7 in /opt/hostedtoolcache/Python/3.13.1/x64/lib/python3.13/site-packages (from pandas-&gt;datasets) (2025.1)
Requirement already satisfied: six&gt;=1.5 in /opt/hostedtoolcache/Python/3.13.1/x64/lib/python3.13/site-packages (from python-dateutil&gt;=2.8.2-&gt;pandas-&gt;datasets) (1.17.0)
Downloading datasets-3.2.0-py3-none-any.whl (480 kB)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading dill-0.3.8-py3-none-any.whl (116 kB)
Downloading fsspec-2024.9.0-py3-none-any.whl (179 kB)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading aiohttp-3.11.12-cp313-cp313-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (1.7 MB)
?25l   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">0.0/1.7 MB</span> <span class=" -Color -Color-Red">?</span> eta <span class=" -Color -Color-Cyan">-:--:--</span>
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">1.7/1.7 MB</span> <span class=" -Color -Color-Red">73.6 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:00</span>
?25hDownloading huggingface_hub-0.28.1-py3-none-any.whl (464 kB)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading multiprocess-0.70.16-py312-none-any.whl (146 kB)
Downloading pyarrow-19.0.0-cp313-cp313-manylinux_2_28_x86_64.whl (42.1 MB)
?25l   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">0.0/42.1 MB</span> <span class=" -Color -Color-Red">?</span> eta <span class=" -Color -Color-Cyan">-:--:--</span>
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">42.1/42.1 MB</span> <span class=" -Color -Color-Red">213.1 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:00</span>
?25hDownloading tqdm-4.67.1-py3-none-any.whl (78 kB)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading filelock-3.17.0-py3-none-any.whl (16 kB)
Downloading xxhash-3.5.0-cp313-cp313-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (194 kB)
Downloading aiohappyeyeballs-2.4.4-py3-none-any.whl (14 kB)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading aiosignal-1.3.2-py2.py3-none-any.whl (7.6 kB)
Downloading frozenlist-1.5.0-cp313-cp313-manylinux_2_5_x86_64.manylinux1_x86_64.manylinux_2_17_x86_64.manylinux2014_x86_64.whl (267 kB)
Downloading multidict-6.1.0-cp313-cp313-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (131 kB)
Downloading propcache-0.2.1-cp313-cp313-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (227 kB)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading yarl-1.18.3-cp313-cp313-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (339 kB)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Installing collected packages: xxhash, tqdm, pyarrow, propcache, multidict, fsspec, frozenlist, filelock, dill, aiohappyeyeballs, yarl, multiprocess, huggingface-hub, aiosignal, aiohttp, datasets
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Successfully installed aiohappyeyeballs-2.4.4 aiohttp-3.11.12 aiosignal-1.3.2 datasets-3.2.0 dill-0.3.8 filelock-3.17.0 frozenlist-1.5.0 fsspec-2024.9.0 huggingface-hub-0.28.1 multidict-6.1.0 multiprocess-0.70.16 propcache-0.2.1 pyarrow-19.0.0 tqdm-4.67.1 xxhash-3.5.0 yarl-1.18.3
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Note: you may need to restart the kernel to use updated packages.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Yellow">WARNING: Package(s) not found: transformers</span>

</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Collecting transformers
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Downloading transformers-4.48.2-py3-none-any.whl.metadata (44 kB)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Requirement already satisfied: filelock in /opt/hostedtoolcache/Python/3.13.1/x64/lib/python3.13/site-packages (from transformers) (3.17.0)
Requirement already satisfied: huggingface-hub&lt;1.0,&gt;=0.24.0 in /opt/hostedtoolcache/Python/3.13.1/x64/lib/python3.13/site-packages (from transformers) (0.28.1)
Requirement already satisfied: numpy&gt;=1.17 in /opt/hostedtoolcache/Python/3.13.1/x64/lib/python3.13/site-packages (from transformers) (2.2.2)
Requirement already satisfied: packaging&gt;=20.0 in /opt/hostedtoolcache/Python/3.13.1/x64/lib/python3.13/site-packages (from transformers) (24.2)
Requirement already satisfied: pyyaml&gt;=5.1 in /opt/hostedtoolcache/Python/3.13.1/x64/lib/python3.13/site-packages (from transformers) (6.0.2)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Collecting regex!=2019.12.17 (from transformers)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Downloading regex-2024.11.6-cp313-cp313-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (40 kB)
Requirement already satisfied: requests in /opt/hostedtoolcache/Python/3.13.1/x64/lib/python3.13/site-packages (from transformers) (2.32.3)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Collecting tokenizers&lt;0.22,&gt;=0.21 (from transformers)
  Downloading tokenizers-0.21.0-cp39-abi3-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (6.7 kB)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Collecting safetensors&gt;=0.4.1 (from transformers)
  Downloading safetensors-0.5.2-cp38-abi3-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (3.8 kB)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Requirement already satisfied: tqdm&gt;=4.27 in /opt/hostedtoolcache/Python/3.13.1/x64/lib/python3.13/site-packages (from transformers) (4.67.1)
Requirement already satisfied: fsspec&gt;=2023.5.0 in /opt/hostedtoolcache/Python/3.13.1/x64/lib/python3.13/site-packages (from huggingface-hub&lt;1.0,&gt;=0.24.0-&gt;transformers) (2024.9.0)
Requirement already satisfied: typing-extensions&gt;=3.7.4.3 in /opt/hostedtoolcache/Python/3.13.1/x64/lib/python3.13/site-packages (from huggingface-hub&lt;1.0,&gt;=0.24.0-&gt;transformers) (4.12.2)
Requirement already satisfied: charset-normalizer&lt;4,&gt;=2 in /opt/hostedtoolcache/Python/3.13.1/x64/lib/python3.13/site-packages (from requests-&gt;transformers) (3.4.1)
Requirement already satisfied: idna&lt;4,&gt;=2.5 in /opt/hostedtoolcache/Python/3.13.1/x64/lib/python3.13/site-packages (from requests-&gt;transformers) (3.10)
Requirement already satisfied: urllib3&lt;3,&gt;=1.21.1 in /opt/hostedtoolcache/Python/3.13.1/x64/lib/python3.13/site-packages (from requests-&gt;transformers) (2.3.0)
Requirement already satisfied: certifi&gt;=2017.4.17 in /opt/hostedtoolcache/Python/3.13.1/x64/lib/python3.13/site-packages (from requests-&gt;transformers) (2025.1.31)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading transformers-4.48.2-py3-none-any.whl (9.7 MB)
?25l   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">0.0/9.7 MB</span> <span class=" -Color -Color-Red">?</span> eta <span class=" -Color -Color-Cyan">-:--:--</span>
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">9.7/9.7 MB</span> <span class=" -Color -Color-Red">118.4 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:00</span>
?25hDownloading regex-2024.11.6-cp313-cp313-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (796 kB)
?25l   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">0.0/796.9 kB</span> <span class=" -Color -Color-Red">?</span> eta <span class=" -Color -Color-Cyan">-:--:--</span>
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">796.9/796.9 kB</span> <span class=" -Color -Color-Red">110.5 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:00</span>
?25hDownloading safetensors-0.5.2-cp38-abi3-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (461 kB)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading tokenizers-0.21.0-cp39-abi3-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (3.0 MB)
?25l   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">0.0/3.0 MB</span> <span class=" -Color -Color-Red">?</span> eta <span class=" -Color -Color-Cyan">-:--:--</span>
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">3.0/3.0 MB</span> <span class=" -Color -Color-Red">179.9 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:00</span>
?25h
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Installing collected packages: safetensors, regex, tokenizers, transformers
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Successfully installed regex-2024.11.6 safetensors-0.5.2 tokenizers-0.21.0 transformers-4.48.2
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Note: you may need to restart the kernel to use updated packages.
</pre></div>
</div>
</div>
</div>
<p><strong>Q1.</strong> Download the dataset <a class="reference external" href="https://huggingface.co/datasets/ai4bharat/naamapadam">https://huggingface.co/datasets/ai4bharat/naamapadam</a> from the hub and choose all the correct statements about the dataset. <br>
Note: You could answer some of the questions by directly visiting the given link. However, we strongly recommend you to use the suitable functions in datasets modules to get the info about the dataset.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">datasets</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">datasets</span><span class="w"> </span><span class="kn">import</span> <span class="n">load_dataset</span><span class="p">;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/hostedtoolcache/Python/3.13.1/x64/lib/python3.13/site-packages/tqdm/auto.py:21: TqdmWarning: IProgress not found. Please update jupyter and ipywidgets. See https://ipywidgets.readthedocs.io/en/stable/user_install.html
  from .autonotebook import tqdm as notebook_tqdm
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">datasets</span><span class="w"> </span><span class="kn">import</span> <span class="n">get_dataset_config_names</span>

<span class="c1"># Define a function to fetch and print dataset configurations</span>
<span class="k">def</span><span class="w"> </span><span class="nf">configs</span><span class="p">(</span><span class="n">dataset_name</span><span class="p">):</span>
    <span class="n">configs</span> <span class="o">=</span> <span class="n">get_dataset_config_names</span><span class="p">(</span><span class="n">dataset_name</span><span class="p">)</span>  <span class="c1"># Fetch configurations</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No. of configs - </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">configs</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>  <span class="c1"># Print number of configurations</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Names of configs - </span><span class="si">{</span><span class="n">configs</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>  <span class="c1"># Print configuration names</span>

<span class="c1"># Call the function with the dataset name</span>
<span class="n">configs</span><span class="p">(</span><span class="s2">&quot;ai4bharat/naamapadam&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>No. of configs - 11
Names of configs - [&#39;as&#39;, &#39;bn&#39;, &#39;gu&#39;, &#39;hi&#39;, &#39;kn&#39;, &#39;ml&#39;, &#39;mr&#39;, &#39;or&#39;, &#39;pa&#39;, &#39;ta&#39;, &#39;te&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># hi = datasets.load_dataset(&quot;ai4bharat/naamapadam&quot;, &quot;hi&quot;)</span>
<span class="c1"># hi</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ta</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">load_dataset</span><span class="p">(</span><span class="s2">&quot;ai4bharat/naamapadam&quot;</span><span class="p">,</span> <span class="s2">&quot;ta&quot;</span><span class="p">)</span>
<span class="n">ta</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Generating train split:   0%|          | 0/497882 [00:00&lt;?, ? examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Generating train split:  20%|██        | 101000/497882 [00:00&lt;00:00, 997451.66 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Generating train split:  44%|████▍     | 219000/497882 [00:00&lt;00:00, 1099109.25 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Generating train split:  68%|██████▊   | 339000/497882 [00:00&lt;00:00, 1138827.69 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Generating train split:  91%|█████████ | 454000/497882 [00:00&lt;00:00, 1142884.27 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Generating train split: 100%|██████████| 497882/497882 [00:00&lt;00:00, 1134211.62 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Generating test split:   0%|          | 0/758 [00:00&lt;?, ? examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Generating test split: 100%|██████████| 758/758 [00:00&lt;00:00, 287249.95 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Generating validation split:   0%|          | 0/2795 [00:00&lt;?, ? examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Generating validation split: 100%|██████████| 2795/2795 [00:00&lt;00:00, 698301.15 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>DatasetDict({
    train: Dataset({
        features: [&#39;tokens&#39;, &#39;ner_tags&#39;],
        num_rows: 497882
    })
    test: Dataset({
        features: [&#39;tokens&#39;, &#39;ner_tags&#39;],
        num_rows: 758
    })
    validation: Dataset({
        features: [&#39;tokens&#39;, &#39;ner_tags&#39;],
        num_rows: 2795
    })
})
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="mi">497882</span><span class="o">+</span><span class="mi">758</span><span class="o">+</span><span class="mi">2795</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>501435
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># unique_tags = set(tag for example in hi[&quot;train&quot;][&quot;ner_tags&quot;] for tag in example)</span>
<span class="c1"># print(f&quot;Unique NER tags: {unique_tags}&quot;)</span>
<span class="c1"># print(f&quot;Number of classes: {len(unique_tags)}&quot;)</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Q2</strong>:Download the <strong>training split</strong> of the tamil (ta) subset of the dataset and store in a variable named “ds”.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ds</span> <span class="o">=</span> <span class="n">ta</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ds</span>
<span class="c1"># ds.cache_files</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>DatasetDict({
    train: Dataset({
        features: [&#39;tokens&#39;, &#39;ner_tags&#39;],
        num_rows: 497882
    })
    test: Dataset({
        features: [&#39;tokens&#39;, &#39;ner_tags&#39;],
        num_rows: 758
    })
    validation: Dataset({
        features: [&#39;tokens&#39;, &#39;ner_tags&#39;],
        num_rows: 2795
    })
})
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="nb">print</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s2">&quot;~/.cache/huggingface/datasets/ai4bharat___naamapadam/&quot;</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s2">&quot;~/.cache/huggingface/datasets/ai4bharat___naamapadam/ta&quot;</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s2">&quot;~/.cache/huggingface/datasets/ai4bharat___naamapadam/ta/1.0.0/&quot;</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s2">&quot;~/.cache/huggingface/datasets/ai4bharat___naamapadam/ta/1.0.0/9d4f21ac57d11ed4f9ea64854fdc9f5618e61acc&quot;</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;ta&#39;]
[&#39;1.0.0&#39;]
[&#39;9d4f21ac57d11ed4f9ea64854fdc9f5618e61acc.incomplete_info.lock&#39;, &#39;9d4f21ac57d11ed4f9ea64854fdc9f5618e61acc_builder.lock&#39;, &#39;9d4f21ac57d11ed4f9ea64854fdc9f5618e61acc&#39;]
[&#39;LICENSE&#39;, &#39;naamapadam-train.arrow&#39;, &#39;naamapadam-test.arrow&#39;, &#39;naamapadam-validation.arrow&#39;, &#39;dataset_info.json&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Path to the Tamil dataset cache directory</span>
<span class="n">cache_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s2">&quot;~/.cache/huggingface/datasets/ai4bharat___naamapadam/ta/&quot;</span><span class="p">)</span>

<span class="c1"># Function to calculate directory size</span>
<span class="k">def</span><span class="w"> </span><span class="nf">get_dir_size</span><span class="p">(</span><span class="n">directory</span><span class="p">):</span>
    <span class="n">total_size</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">dirpath</span><span class="p">,</span> <span class="n">dirnames</span><span class="p">,</span> <span class="n">filenames</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">walk</span><span class="p">(</span><span class="n">directory</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">filenames</span><span class="p">:</span>
            <span class="n">fp</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dirpath</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
            <span class="n">total_size</span> <span class="o">+=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">getsize</span><span class="p">(</span><span class="n">fp</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">total_size</span>

<span class="c1"># Get the size in bytes and convert to MB</span>
<span class="n">size_in_bytes</span> <span class="o">=</span> <span class="n">get_dir_size</span><span class="p">(</span><span class="n">cache_dir</span><span class="p">)</span>
<span class="n">size_in_mb</span> <span class="o">=</span> <span class="n">size_in_bytes</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1024</span> <span class="o">*</span> <span class="mi">1024</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Dataset size: </span><span class="si">{</span><span class="n">size_in_mb</span><span class="si">}</span><span class="s2"> MB&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Dataset size: 179.29018783569336 MB
</pre></div>
</div>
</div>
</div>
<p><strong>Q6: Count number of tokens:</strong> <br>
Create a new column named ``num_tokens”. Compute the number of tokens (words) in each sample and keep it in the newly created column. How many tokens (in millions) are there in the entire dataset?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">cnot</span><span class="p">(</span><span class="n">example</span><span class="p">):</span>
  <span class="n">example</span><span class="p">[</span><span class="s1">&#39;num_tokens&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">example</span><span class="p">[</span><span class="s1">&#39;tokens&#39;</span><span class="p">])</span>
  <span class="k">return</span> <span class="n">example</span>

<span class="n">ds</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">cnot</span><span class="p">)</span>
<span class="n">ds</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:   0%|          | 0/497882 [00:00&lt;?, ? examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:   0%|          | 2000/497882 [00:00&lt;00:27, 17942.82 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:   1%|          | 4658/497882 [00:00&lt;00:27, 17784.97 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:   1%|▏         | 7386/497882 [00:00&lt;00:27, 17975.94 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:   2%|▏         | 9256/497882 [00:00&lt;00:26, 18201.19 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:   2%|▏         | 11226/497882 [00:00&lt;00:26, 18666.26 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:   3%|▎         | 13160/497882 [00:00&lt;00:25, 18872.75 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:   3%|▎         | 15092/497882 [00:00&lt;00:25, 19005.08 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:   3%|▎         | 17016/497882 [00:00&lt;00:25, 19074.88 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:   4%|▍         | 19007/497882 [00:01&lt;00:24, 19325.79 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:   4%|▍         | 21943/497882 [00:01&lt;00:24, 19421.56 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:   5%|▍         | 23953/497882 [00:01&lt;00:24, 19603.48 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:   5%|▌         | 26855/497882 [00:01&lt;00:24, 19505.71 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:   6%|▌         | 29720/497882 [00:01&lt;00:24, 19363.01 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:   7%|▋         | 32623/497882 [00:01&lt;00:24, 19357.56 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:   7%|▋         | 35486/497882 [00:01&lt;00:23, 19269.27 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:   8%|▊         | 38344/497882 [00:02&lt;00:23, 19197.56 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:   8%|▊         | 41000/497882 [00:02&lt;00:24, 18660.37 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:   9%|▊         | 42932/497882 [00:02&lt;00:24, 18807.72 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:   9%|▉         | 44851/497882 [00:02&lt;00:23, 18896.33 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:   9%|▉         | 46781/497882 [00:02&lt;00:23, 18997.38 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  10%|▉         | 48706/497882 [00:02&lt;00:23, 19063.34 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  10%|█         | 50618/497882 [00:02&lt;00:23, 19077.57 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  11%|█         | 52546/497882 [00:02&lt;00:23, 19131.10 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  11%|█         | 54515/497882 [00:02&lt;00:22, 19290.17 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  11%|█▏        | 56502/497882 [00:02&lt;00:22, 19457.94 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  12%|█▏        | 59342/497882 [00:03&lt;00:22, 19252.67 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  12%|█▏        | 62000/497882 [00:03&lt;00:23, 18518.27 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  13%|█▎        | 64856/497882 [00:03&lt;00:23, 18689.49 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  13%|█▎        | 66740/497882 [00:03&lt;00:23, 18724.06 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  14%|█▍        | 68712/497882 [00:03&lt;00:22, 18966.19 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  14%|█▍        | 70635/497882 [00:03&lt;00:22, 19033.73 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  15%|█▍        | 72598/497882 [00:03&lt;00:22, 19193.21 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  15%|█▌        | 75271/497882 [00:03&lt;00:22, 18679.54 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  15%|█▌        | 77154/497882 [00:04&lt;00:22, 18716.74 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  16%|█▌        | 79962/497882 [00:04&lt;00:22, 18715.55 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  16%|█▋        | 81863/497882 [00:04&lt;00:22, 18789.47 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  17%|█▋        | 84682/497882 [00:04&lt;00:21, 18787.25 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  17%|█▋        | 87125/497882 [00:04&lt;00:22, 17946.31 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  18%|█▊        | 89000/497882 [00:04&lt;00:22, 18001.98 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  18%|█▊        | 90949/497882 [00:04&lt;00:22, 18378.24 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  19%|█▊        | 92883/497882 [00:04&lt;00:21, 18633.48 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  19%|█▉        | 94803/497882 [00:05&lt;00:21, 18787.75 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  19%|█▉        | 96753/497882 [00:05&lt;00:21, 18984.95 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  20%|█▉        | 98699/497882 [00:05&lt;00:20, 19120.65 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  20%|██        | 101506/497882 [00:05&lt;00:20, 18960.59 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  21%|██        | 104387/497882 [00:05&lt;00:20, 19044.12 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  22%|██▏       | 107218/497882 [00:05&lt;00:20, 18982.96 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  22%|██▏       | 109167/497882 [00:05&lt;00:20, 19103.32 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  22%|██▏       | 111134/497882 [00:05&lt;00:20, 19247.50 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  23%|██▎       | 114000/497882 [00:06&lt;00:20, 19182.28 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  23%|██▎       | 116828/497882 [00:06&lt;00:19, 19070.41 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  24%|██▍       | 119695/497882 [00:06&lt;00:19, 19081.40 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  25%|██▍       | 122317/497882 [00:06&lt;00:20, 18571.94 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  25%|██▌       | 124636/497882 [00:06&lt;00:22, 16954.19 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  25%|██▌       | 126552/497882 [00:06&lt;00:21, 17440.96 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  26%|██▌       | 128461/497882 [00:06&lt;00:20, 17834.29 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  26%|██▋       | 131175/497882 [00:06&lt;00:20, 17920.56 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  27%|██▋       | 133693/497882 [00:07&lt;00:20, 17545.66 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  27%|██▋       | 136391/497882 [00:07&lt;00:20, 17682.96 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  28%|██▊       | 138271/497882 [00:07&lt;00:20, 17941.78 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  28%|██▊       | 140128/497882 [00:07&lt;00:19, 18097.19 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  29%|██▊       | 142014/497882 [00:07&lt;00:19, 18293.74 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  29%|██▉       | 143980/497882 [00:07&lt;00:18, 18660.85 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  29%|██▉       | 146810/497882 [00:07&lt;00:18, 18730.37 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  30%|███       | 149654/497882 [00:07&lt;00:18, 18805.65 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  31%|███       | 152387/497882 [00:08&lt;00:18, 18609.77 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  31%|███       | 155049/497882 [00:08&lt;00:18, 18330.38 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  32%|███▏      | 157689/497882 [00:08&lt;00:18, 18095.87 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  32%|███▏      | 159585/497882 [00:08&lt;00:18, 18294.34 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  32%|███▏      | 161532/497882 [00:08&lt;00:18, 18581.36 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  33%|███▎      | 163460/497882 [00:08&lt;00:17, 18762.13 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  33%|███▎      | 166221/497882 [00:08&lt;00:17, 18629.67 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  34%|███▍      | 169000/497882 [00:09&lt;00:17, 18384.73 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  34%|███▍      | 171031/497882 [00:09&lt;00:17, 18779.12 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  35%|███▍      | 173000/497882 [00:09&lt;00:17, 18760.79 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  35%|███▌      | 175000/497882 [00:09&lt;00:17, 18909.40 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  36%|███▌      | 176984/497882 [00:09&lt;00:16, 19162.25 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  36%|███▌      | 178989/497882 [00:09&lt;00:16, 19408.41 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  36%|███▋      | 180965/497882 [00:09&lt;00:16, 19504.60 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  37%|███▋      | 183874/497882 [00:09&lt;00:16, 19458.49 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  38%|███▊      | 186764/497882 [00:09&lt;00:16, 19388.01 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  38%|███▊      | 189695/497882 [00:10&lt;00:15, 19436.92 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  39%|███▊      | 192547/497882 [00:10&lt;00:15, 19299.35 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  39%|███▉      | 195431/497882 [00:10&lt;00:15, 19275.14 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  40%|███▉      | 198209/497882 [00:10&lt;00:15, 19037.30 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  40%|████      | 201086/497882 [00:10&lt;00:15, 19078.30 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  41%|████      | 203000/497882 [00:10&lt;00:15, 19018.13 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  41%|████      | 205000/497882 [00:10&lt;00:15, 19163.23 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  42%|████▏     | 207000/497882 [00:11&lt;00:15, 19272.01 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  42%|████▏     | 209001/497882 [00:11&lt;00:14, 19417.88 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  42%|████▏     | 211000/497882 [00:11&lt;00:14, 19266.43 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  43%|████▎     | 213000/497882 [00:11&lt;00:14, 19419.62 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  43%|████▎     | 215000/497882 [00:11&lt;00:14, 19408.48 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  44%|████▎     | 217000/497882 [00:11&lt;00:14, 18959.25 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  44%|████▍     | 219805/497882 [00:11&lt;00:14, 18858.04 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  45%|████▍     | 221700/497882 [00:11&lt;00:14, 18873.31 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  45%|████▍     | 223602/497882 [00:11&lt;00:14, 18908.76 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  45%|████▌     | 226447/497882 [00:12&lt;00:14, 18924.79 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  46%|████▌     | 228344/497882 [00:12&lt;00:14, 18934.44 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  46%|████▋     | 231103/497882 [00:12&lt;00:14, 18735.45 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  47%|████▋     | 233000/497882 [00:12&lt;00:14, 18768.00 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  47%|████▋     | 235004/497882 [00:12&lt;00:13, 18954.62 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  48%|████▊     | 237000/497882 [00:12&lt;00:13, 19140.53 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  48%|████▊     | 239000/497882 [00:12&lt;00:13, 19293.52 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  48%|████▊     | 241000/497882 [00:12&lt;00:13, 19408.58 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  49%|████▉     | 243896/497882 [00:12&lt;00:13, 19365.97 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  49%|████▉     | 245837/497882 [00:13&lt;00:13, 19374.38 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  50%|████▉     | 247869/497882 [00:13&lt;00:12, 19631.64 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  50%|█████     | 249846/497882 [00:13&lt;00:12, 19666.88 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  51%|█████     | 252733/497882 [00:13&lt;00:12, 19506.87 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  51%|█████     | 254721/497882 [00:13&lt;00:12, 19601.64 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  52%|█████▏    | 257614/497882 [00:13&lt;00:12, 19484.10 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  52%|█████▏    | 260514/497882 [00:13&lt;00:12, 19431.07 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  53%|█████▎    | 263331/497882 [00:13&lt;00:12, 19214.23 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  53%|█████▎    | 266219/497882 [00:14&lt;00:12, 19223.58 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  54%|█████▍    | 269021/497882 [00:14&lt;00:12, 19051.49 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  54%|█████▍    | 270936/497882 [00:14&lt;00:11, 19071.63 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  55%|█████▍    | 273799/497882 [00:14&lt;00:11, 19074.59 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  56%|█████▌    | 276667/497882 [00:14&lt;00:11, 19085.17 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  56%|█████▌    | 279478/497882 [00:14&lt;00:11, 18972.56 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  57%|█████▋    | 282356/497882 [00:14&lt;00:11, 19036.97 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  57%|█████▋    | 284286/497882 [00:15&lt;00:11, 19094.66 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  57%|█████▋    | 286221/497882 [00:15&lt;00:11, 19152.59 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  58%|█████▊    | 289047/497882 [00:15&lt;00:10, 19041.90 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  59%|█████▊    | 291687/497882 [00:15&lt;00:11, 17643.21 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  59%|█████▉    | 293481/497882 [00:15&lt;00:11, 17708.40 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  59%|█████▉    | 295417/497882 [00:15&lt;00:11, 18115.08 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  60%|█████▉    | 298132/497882 [00:15&lt;00:11, 18103.69 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  60%|██████    | 299974/497882 [00:15&lt;00:10, 18180.02 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  61%|██████    | 301919/497882 [00:16&lt;00:10, 18511.73 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  61%|██████    | 303862/497882 [00:16&lt;00:10, 18757.93 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  61%|██████▏   | 305761/497882 [00:16&lt;00:10, 18820.15 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  62%|██████▏   | 307685/497882 [00:16&lt;00:10, 18937.88 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  62%|██████▏   | 310483/497882 [00:16&lt;00:09, 18825.72 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  63%|██████▎   | 312409/497882 [00:16&lt;00:09, 18940.48 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  63%|██████▎   | 314384/497882 [00:16&lt;00:09, 19161.24 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  64%|██████▎   | 317106/497882 [00:16&lt;00:09, 18782.22 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  64%|██████▍   | 319046/497882 [00:16&lt;00:09, 18940.08 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  65%|██████▍   | 321926/497882 [00:17&lt;00:09, 19029.62 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  65%|██████▌   | 323894/497882 [00:17&lt;00:09, 19192.64 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  66%|██████▌   | 326571/497882 [00:17&lt;00:09, 18714.11 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  66%|██████▌   | 329209/497882 [00:17&lt;00:09, 18332.61 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  67%|██████▋   | 332000/497882 [00:17&lt;00:09, 18284.91 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  67%|██████▋   | 334004/497882 [00:17&lt;00:08, 18625.99 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  68%|██████▊   | 336762/497882 [00:17&lt;00:08, 18542.99 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  68%|██████▊   | 339460/497882 [00:18&lt;00:08, 18360.85 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  69%|██████▊   | 342262/497882 [00:18&lt;00:08, 18458.95 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  69%|██████▉   | 344193/497882 [00:18&lt;00:08, 18653.86 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  70%|██████▉   | 347000/497882 [00:18&lt;00:08, 18496.62 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  70%|███████   | 349000/497882 [00:18&lt;00:07, 18682.53 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  70%|███████   | 351000/497882 [00:18&lt;00:07, 18967.31 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  71%|███████   | 353003/497882 [00:18&lt;00:07, 19099.46 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  71%|███████▏  | 355000/497882 [00:18&lt;00:07, 19308.88 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  72%|███████▏  | 357918/497882 [00:18&lt;00:07, 19357.35 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  72%|███████▏  | 360846/497882 [00:19&lt;00:07, 19410.92 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  73%|███████▎  | 362794/497882 [00:19&lt;00:06, 19426.35 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  73%|███████▎  | 364745/497882 [00:19&lt;00:06, 19444.62 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  74%|███████▎  | 366715/497882 [00:19&lt;00:06, 19510.78 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  74%|███████▍  | 369624/497882 [00:19&lt;00:06, 19463.68 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  75%|███████▍  | 372503/497882 [00:19&lt;00:06, 19368.75 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  75%|███████▌  | 375378/497882 [00:19&lt;00:06, 19299.82 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  76%|███████▌  | 377335/497882 [00:19&lt;00:06, 19363.00 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  76%|███████▋  | 380201/497882 [00:20&lt;00:06, 19273.35 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  77%|███████▋  | 383000/497882 [00:20&lt;00:06, 19048.36 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  77%|███████▋  | 385000/497882 [00:20&lt;00:05, 19207.51 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  78%|███████▊  | 386972/497882 [00:20&lt;00:05, 19334.09 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  78%|███████▊  | 388928/497882 [00:20&lt;00:05, 19391.05 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  79%|███████▊  | 391813/497882 [00:20&lt;00:05, 19327.89 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  79%|███████▉  | 394708/497882 [00:20&lt;00:05, 19316.46 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  80%|███████▉  | 397556/497882 [00:21&lt;00:05, 19203.73 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  80%|████████  | 400415/497882 [00:21&lt;00:05, 19154.93 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  81%|████████  | 403130/497882 [00:21&lt;00:05, 18822.51 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  82%|████████▏ | 406000/497882 [00:21&lt;00:04, 18629.95 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  82%|████████▏ | 408001/497882 [00:21&lt;00:04, 18826.44 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  83%|████████▎ | 410794/497882 [00:21&lt;00:04, 18756.26 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  83%|████████▎ | 413434/497882 [00:21&lt;00:04, 18386.57 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  84%|████████▎ | 416257/497882 [00:22&lt;00:04, 18519.30 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  84%|████████▍ | 418122/497882 [00:22&lt;00:04, 18546.54 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  84%|████████▍ | 420110/497882 [00:22&lt;00:04, 18873.24 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  85%|████████▍ | 422035/497882 [00:22&lt;00:03, 18969.14 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  85%|████████▌ | 424000/497882 [00:22&lt;00:03, 18763.30 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  86%|████████▌ | 426812/497882 [00:22&lt;00:03, 18754.23 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  86%|████████▋ | 429678/497882 [00:22&lt;00:03, 18871.40 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  87%|████████▋ | 432465/497882 [00:22&lt;00:03, 18774.24 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  87%|████████▋ | 435148/497882 [00:23&lt;00:03, 18488.87 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  88%|████████▊ | 437000/497882 [00:23&lt;00:03, 18232.47 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  88%|████████▊ | 439000/497882 [00:23&lt;00:03, 18440.55 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  89%|████████▊ | 441762/497882 [00:23&lt;00:03, 18428.76 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  89%|████████▉ | 443619/497882 [00:23&lt;00:02, 18461.61 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  90%|████████▉ | 446149/497882 [00:23&lt;00:02, 17907.77 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  90%|█████████ | 448930/497882 [00:23&lt;00:02, 18113.00 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  91%|█████████ | 450856/497882 [00:23&lt;00:02, 18385.11 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  91%|█████████ | 452770/497882 [00:24&lt;00:02, 18576.74 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  91%|█████████▏| 454722/497882 [00:24&lt;00:02, 18825.98 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  92%|█████████▏| 457465/497882 [00:24&lt;00:02, 18626.18 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  92%|█████████▏| 459681/497882 [00:24&lt;00:02, 16862.98 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  93%|█████████▎| 461572/497882 [00:24&lt;00:02, 17353.42 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  93%|█████████▎| 463512/497882 [00:24&lt;00:01, 17874.90 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  94%|█████████▎| 466210/497882 [00:24&lt;00:01, 17912.15 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  94%|█████████▍| 468089/497882 [00:24&lt;00:01, 18131.99 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  94%|█████████▍| 470000/497882 [00:24&lt;00:01, 18109.94 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  95%|█████████▍| 472000/497882 [00:25&lt;00:01, 18355.09 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  95%|█████████▌| 474000/497882 [00:25&lt;00:01, 18535.45 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  96%|█████████▌| 476000/497882 [00:25&lt;00:01, 18798.62 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  96%|█████████▌| 478864/497882 [00:25&lt;00:01, 18904.61 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  97%|█████████▋| 481709/497882 [00:25&lt;00:00, 18921.07 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  97%|█████████▋| 484556/497882 [00:25&lt;00:00, 18936.12 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  98%|█████████▊| 487365/497882 [00:25&lt;00:00, 18866.83 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  98%|█████████▊| 489266/497882 [00:26&lt;00:00, 18897.34 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  99%|█████████▉| 492018/497882 [00:26&lt;00:00, 18605.84 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  99%|█████████▉| 494009/497882 [00:26&lt;00:00, 18798.09 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map: 100%|█████████▉| 496000/497882 [00:26&lt;00:00, 18736.55 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map: 100%|██████████| 497882/497882 [00:26&lt;00:00, 13081.14 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map: 100%|██████████| 497882/497882 [00:26&lt;00:00, 18686.65 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:   0%|          | 0/758 [00:00&lt;?, ? examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map: 100%|██████████| 758/758 [00:00&lt;00:00, 15177.82 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:   0%|          | 0/2795 [00:00&lt;?, ? examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  72%|███████▏  | 2001/2795 [00:00&lt;00:00, 19408.96 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map: 100%|██████████| 2795/2795 [00:00&lt;00:00, 18467.85 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>DatasetDict({
    train: Dataset({
        features: [&#39;tokens&#39;, &#39;ner_tags&#39;, &#39;num_tokens&#39;],
        num_rows: 497882
    })
    test: Dataset({
        features: [&#39;tokens&#39;, &#39;ner_tags&#39;, &#39;num_tokens&#39;],
        num_rows: 758
    })
    validation: Dataset({
        features: [&#39;tokens&#39;, &#39;ner_tags&#39;, &#39;num_tokens&#39;],
        num_rows: 2795
    })
})
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">total_tokens</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">ds</span><span class="p">[</span><span class="s1">&#39;train&#39;</span><span class="p">][</span><span class="s1">&#39;num_tokens&#39;</span><span class="p">])</span> <span class="o">+</span> <span class="nb">sum</span><span class="p">(</span><span class="n">ds</span><span class="p">[</span><span class="s1">&#39;validation&#39;</span><span class="p">][</span><span class="s1">&#39;num_tokens&#39;</span><span class="p">])</span> <span class="o">+</span> <span class="nb">sum</span><span class="p">(</span><span class="n">ds</span><span class="p">[</span><span class="s1">&#39;test&#39;</span><span class="p">][</span><span class="s1">&#39;num_tokens&#39;</span><span class="p">])</span>

<span class="c1"># Convert to millions of tokens</span>
<span class="n">total_tokens_million</span> <span class="o">=</span> <span class="n">total_tokens</span> <span class="o">/</span> <span class="mi">1_000_000</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Total number of tokens: </span><span class="si">{</span><span class="n">total_tokens</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Total number of tokens (in millions): </span><span class="si">{</span><span class="n">total_tokens_million</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total number of tokens: 6001876
Total number of tokens (in millions): 6.00
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Path to the Tamil dataset cache directory</span>
<span class="n">cache_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s2">&quot;~/.cache/huggingface/datasets/ai4bharat___naamapadam/ta/1.0.0&quot;</span><span class="p">)</span>

<span class="c1"># Function to calculate directory size</span>
<span class="k">def</span><span class="w"> </span><span class="nf">get_dir_size</span><span class="p">(</span><span class="n">directory</span><span class="p">):</span>
    <span class="n">total_size</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">dirpath</span><span class="p">,</span> <span class="n">dirnames</span><span class="p">,</span> <span class="n">filenames</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">walk</span><span class="p">(</span><span class="n">directory</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">filenames</span><span class="p">:</span>
            <span class="n">fp</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dirpath</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
            <span class="n">total_size</span> <span class="o">+=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">getsize</span><span class="p">(</span><span class="n">fp</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">total_size</span>

<span class="c1"># Get the size in bytes and convert to MB</span>
<span class="n">size_in_bytes</span> <span class="o">=</span> <span class="n">get_dir_size</span><span class="p">(</span><span class="n">cache_dir</span><span class="p">)</span>
<span class="n">size_in_mb</span> <span class="o">=</span> <span class="n">size_in_bytes</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1024</span> <span class="o">*</span> <span class="mi">1024</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Dataset size: </span><span class="si">{</span><span class="n">size_in_mb</span><span class="si">}</span><span class="s2"> MB&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Dataset size: 362.42800521850586 MB
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="mf">362.42800521850586</span><span class="o">/</span><span class="mf">179.29018783569336</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2.0214603464560215
</pre></div>
</div>
</div>
</div>
<ol class="arabic simple" start="7">
<li><p>Concatenate all the samples across the splits in the following order: [train:test:validation]. Currently, each sample contains a list of words (tokens). Create a sentence by joining the individual words (tokens) in each sample using a single white space as a delimiter and store the resulting sample in a new column named “text”. Create a new dataset by removing the columns “ner tags” and “tokens”. Store the new dataset in the same variable “ds”. Enter the total number of samples in “ds”</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">try</span><span class="p">:</span>
  <span class="n">ds</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">concatenate_datasets</span><span class="p">([</span><span class="n">ds</span><span class="p">[</span><span class="s2">&quot;train&quot;</span><span class="p">],</span><span class="n">ds</span><span class="p">[</span><span class="s2">&quot;test&quot;</span><span class="p">],</span><span class="n">ds</span><span class="p">[</span><span class="s2">&quot;validation&quot;</span><span class="p">]])</span>
  <span class="nb">print</span><span class="p">(</span><span class="n">ds</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
  <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ERROR: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Dataset({
    features: [&#39;tokens&#39;, &#39;ner_tags&#39;, &#39;num_tokens&#39;],
    num_rows: 501435
})
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># def cnot(example):</span>
<span class="c1">#   example[&#39;num_tokens&#39;] = len(example[&#39;tokens&#39;])</span>
<span class="c1">#   return example</span>

<span class="c1"># ds = ds.map(cnot)</span>
<span class="c1"># ds</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">modi</span><span class="p">(</span><span class="n">sample</span><span class="p">):</span>
  <span class="n">sample</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">sample</span><span class="p">[</span><span class="s1">&#39;tokens&#39;</span><span class="p">])</span>
  <span class="k">return</span> <span class="n">sample</span>
<span class="n">ds</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">modi</span><span class="p">)</span>
<span class="n">ds</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:   0%|          | 0/501435 [00:00&lt;?, ? examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:   0%|          | 1736/501435 [00:00&lt;00:29, 17140.73 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:   1%|          | 4027/501435 [00:00&lt;00:31, 15866.73 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:   1%|          | 5999/501435 [00:00&lt;00:29, 16826.19 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:   2%|▏         | 8348/501435 [00:00&lt;00:30, 16298.94 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:   2%|▏         | 10000/501435 [00:00&lt;00:30, 16217.02 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:   2%|▏         | 11698/501435 [00:00&lt;00:29, 16442.58 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:   3%|▎         | 14079/501435 [00:00&lt;00:30, 16218.49 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:   3%|▎         | 15979/501435 [00:00&lt;00:29, 16668.94 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:   4%|▎         | 18283/501435 [00:01&lt;00:29, 16191.09 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:   4%|▍         | 19966/501435 [00:01&lt;00:29, 16334.63 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:   4%|▍         | 22225/501435 [00:01&lt;00:30, 15879.65 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:   5%|▍         | 23959/501435 [00:01&lt;00:29, 16237.12 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:   5%|▌         | 26336/501435 [00:01&lt;00:29, 16090.43 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:   6%|▌         | 28000/501435 [00:01&lt;00:29, 15875.13 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:   6%|▌         | 30358/501435 [00:01&lt;00:29, 15818.43 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:   6%|▋         | 32000/501435 [00:01&lt;00:29, 15801.66 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:   7%|▋         | 33760/501435 [00:02&lt;00:28, 16263.57 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:   7%|▋         | 36000/501435 [00:02&lt;00:29, 15735.21 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:   8%|▊         | 37708/501435 [00:02&lt;00:28, 16073.85 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:   8%|▊         | 40000/501435 [00:02&lt;00:29, 15744.72 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:   8%|▊         | 41737/501435 [00:02&lt;00:28, 16150.91 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:   9%|▊         | 43539/501435 [00:02&lt;00:32, 14098.75 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:   9%|▉         | 45048/501435 [00:02&lt;00:31, 14337.01 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:   9%|▉         | 46766/501435 [00:02&lt;00:30, 15065.38 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  10%|▉         | 49048/501435 [00:03&lt;00:29, 15116.69 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  10%|█         | 50804/501435 [00:03&lt;00:28, 15732.53 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  11%|█         | 53130/501435 [00:03&lt;00:28, 15650.36 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  11%|█         | 54986/501435 [00:03&lt;00:27, 16201.38 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  11%|█▏        | 57389/501435 [00:03&lt;00:27, 16135.52 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  12%|█▏        | 59983/501435 [00:03&lt;00:26, 16360.93 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  12%|█▏        | 62353/501435 [00:03&lt;00:27, 16180.04 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  13%|█▎        | 64000/501435 [00:04&lt;00:27, 16171.74 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  13%|█▎        | 65632/501435 [00:04&lt;00:26, 16204.99 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  13%|█▎        | 67267/501435 [00:04&lt;00:26, 16242.00 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  14%|█▍        | 69000/501435 [00:04&lt;00:26, 16195.39 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  14%|█▍        | 70784/501435 [00:04&lt;00:25, 16647.51 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  15%|█▍        | 73118/501435 [00:04&lt;00:26, 16240.70 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  15%|█▍        | 74988/501435 [00:04&lt;00:25, 16520.60 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  15%|█▌        | 77400/501435 [00:04&lt;00:25, 16361.36 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  16%|█▌        | 79970/501435 [00:04&lt;00:25, 16604.55 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  16%|█▋        | 82250/501435 [00:05&lt;00:25, 16146.89 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  17%|█▋        | 83967/501435 [00:05&lt;00:25, 16242.51 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  17%|█▋        | 86206/501435 [00:05&lt;00:26, 15801.42 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  18%|█▊        | 87898/501435 [00:05&lt;00:25, 16069.82 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  18%|█▊        | 89524/501435 [00:05&lt;00:25, 16116.88 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  18%|█▊        | 92000/501435 [00:05&lt;00:25, 16072.08 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  19%|█▊        | 93749/501435 [00:05&lt;00:24, 16424.36 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  19%|█▉        | 96121/501435 [00:05&lt;00:25, 16209.71 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  20%|█▉        | 97997/501435 [00:06&lt;00:24, 16641.03 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  20%|██        | 100363/501435 [00:06&lt;00:24, 16337.24 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  21%|██        | 102965/501435 [00:06&lt;00:24, 16592.34 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  21%|██        | 105246/501435 [00:06&lt;00:24, 16147.34 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  21%|██▏       | 106953/501435 [00:06&lt;00:24, 16354.79 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  22%|██▏       | 109309/501435 [00:06&lt;00:24, 16137.29 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  22%|██▏       | 111000/501435 [00:06&lt;00:24, 16063.55 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  22%|██▏       | 112785/501435 [00:07&lt;00:23, 16514.38 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  23%|██▎       | 115173/501435 [00:07&lt;00:23, 16302.71 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  23%|██▎       | 116979/501435 [00:07&lt;00:23, 16635.40 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  24%|██▍       | 119286/501435 [00:07&lt;00:23, 16196.06 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  24%|██▍       | 121000/501435 [00:07&lt;00:23, 16135.74 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  24%|██▍       | 122735/501435 [00:07&lt;00:23, 16447.38 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  25%|██▍       | 125000/501435 [00:07&lt;00:23, 15886.90 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  25%|██▌       | 126731/501435 [00:07&lt;00:23, 16244.58 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  26%|██▌       | 129103/501435 [00:08&lt;00:23, 16090.00 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  26%|██▌       | 131000/501435 [00:08&lt;00:22, 16234.94 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  26%|██▋       | 132759/501435 [00:08&lt;00:22, 16580.39 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  27%|██▋       | 134965/501435 [00:08&lt;00:24, 15054.24 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  27%|██▋       | 136526/501435 [00:08&lt;00:24, 15186.19 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  28%|██▊       | 138995/501435 [00:08&lt;00:23, 15618.67 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  28%|██▊       | 141371/501435 [00:08&lt;00:22, 15688.54 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  29%|██▊       | 143000/501435 [00:08&lt;00:23, 15565.10 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  29%|██▉       | 144731/501435 [00:09&lt;00:22, 16001.09 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  29%|██▉       | 147047/501435 [00:09&lt;00:22, 15801.55 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  30%|██▉       | 148741/501435 [00:09&lt;00:21, 16082.36 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  30%|███       | 151000/501435 [00:09&lt;00:22, 15720.38 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  30%|███       | 152737/501435 [00:09&lt;00:21, 16128.03 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  31%|███       | 155095/501435 [00:09&lt;00:21, 15983.81 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  31%|███▏      | 156964/501435 [00:09&lt;00:20, 16437.75 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  32%|███▏      | 159283/501435 [00:09&lt;00:21, 16099.61 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  32%|███▏      | 161000/501435 [00:10&lt;00:21, 16103.29 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  32%|███▏      | 162709/501435 [00:10&lt;00:20, 16354.41 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  33%|███▎      | 165000/501435 [00:10&lt;00:21, 15787.59 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  33%|███▎      | 166708/501435 [00:10&lt;00:20, 16110.10 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  34%|███▎      | 169000/501435 [00:10&lt;00:21, 15747.64 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  34%|███▍      | 170689/501435 [00:10&lt;00:20, 16030.50 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  35%|███▍      | 173086/501435 [00:10&lt;00:20, 16010.03 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  35%|███▍      | 174978/501435 [00:10&lt;00:19, 16517.91 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  35%|███▌      | 177382/501435 [00:11&lt;00:19, 16344.66 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  36%|███▌      | 179797/501435 [00:11&lt;00:19, 16260.65 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  36%|███▋      | 182119/501435 [00:11&lt;00:19, 16006.90 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  37%|███▋      | 183980/501435 [00:11&lt;00:19, 16374.23 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  37%|███▋      | 186340/501435 [00:11&lt;00:19, 16159.47 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  37%|███▋      | 188000/501435 [00:11&lt;00:19, 16065.11 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  38%|███▊      | 189730/501435 [00:11&lt;00:19, 16375.62 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  38%|███▊      | 192130/501435 [00:11&lt;00:19, 16240.14 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  39%|███▊      | 193765/501435 [00:12&lt;00:18, 16267.05 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  39%|███▉      | 196091/501435 [00:12&lt;00:19, 15997.52 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  39%|███▉      | 197989/501435 [00:12&lt;00:18, 16475.16 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  40%|███▉      | 200346/501435 [00:12&lt;00:18, 16210.04 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  40%|████      | 202110/501435 [00:12&lt;00:20, 14686.71 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  41%|████      | 203974/501435 [00:12&lt;00:19, 15417.46 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  41%|████      | 205568/501435 [00:12&lt;00:19, 15546.74 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  41%|████▏     | 207167/501435 [00:12&lt;00:18, 15663.15 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  42%|████▏     | 208969/501435 [00:13&lt;00:18, 16216.31 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  42%|████▏     | 211383/501435 [00:13&lt;00:17, 16166.71 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  43%|████▎     | 213983/501435 [00:13&lt;00:17, 16390.43 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  43%|████▎     | 216339/501435 [00:13&lt;00:17, 16162.97 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  43%|████▎     | 218000/501435 [00:13&lt;00:17, 16024.59 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  44%|████▍     | 219781/501435 [00:13&lt;00:17, 16469.93 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  44%|████▍     | 222170/501435 [00:13&lt;00:17, 16278.25 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  45%|████▍     | 223966/501435 [00:13&lt;00:16, 16559.26 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  45%|████▌     | 226357/501435 [00:14&lt;00:16, 16342.32 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  46%|████▌     | 228972/501435 [00:14&lt;00:16, 16464.70 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  46%|████▌     | 231325/501435 [00:14&lt;00:16, 16209.12 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  47%|████▋     | 233533/501435 [00:14&lt;00:17, 15742.42 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  47%|████▋     | 235966/501435 [00:14&lt;00:16, 15647.05 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  47%|████▋     | 237539/501435 [00:14&lt;00:16, 15663.81 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  48%|████▊     | 239979/501435 [00:14&lt;00:16, 15626.35 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  48%|████▊     | 242330/501435 [00:15&lt;00:16, 15638.85 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  49%|████▊     | 243948/501435 [00:15&lt;00:16, 15760.52 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  49%|████▉     | 246291/501435 [00:15&lt;00:16, 15711.71 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  50%|████▉     | 248463/501435 [00:15&lt;00:16, 15313.60 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  50%|█████     | 250768/501435 [00:15&lt;00:16, 15325.47 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  50%|█████     | 252358/501435 [00:15&lt;00:16, 15456.49 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  51%|█████     | 254000/501435 [00:15&lt;00:15, 15629.86 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  51%|█████     | 255731/501435 [00:15&lt;00:15, 16065.09 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  51%|█████▏    | 258116/501435 [00:16&lt;00:15, 16002.78 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  52%|█████▏    | 259968/501435 [00:16&lt;00:14, 16411.33 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  52%|█████▏    | 262340/501435 [00:16&lt;00:14, 16201.12 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  53%|█████▎    | 264000/501435 [00:16&lt;00:15, 15721.84 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  53%|█████▎    | 265786/501435 [00:16&lt;00:14, 16268.11 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  53%|█████▎    | 268165/501435 [00:16&lt;00:14, 16121.22 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  54%|█████▍    | 269989/501435 [00:16&lt;00:14, 16520.73 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  54%|█████▍    | 272378/501435 [00:16&lt;00:14, 16309.78 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  55%|█████▍    | 274783/501435 [00:17&lt;00:14, 16140.78 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  55%|█████▌    | 277150/501435 [00:17&lt;00:14, 16018.75 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  56%|█████▌    | 278963/501435 [00:17&lt;00:13, 16398.21 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  56%|█████▌    | 281164/501435 [00:17&lt;00:13, 15822.67 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  56%|█████▋    | 282953/501435 [00:17&lt;00:13, 16233.77 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  57%|█████▋    | 285345/501435 [00:17&lt;00:13, 16132.59 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  57%|█████▋    | 287000/501435 [00:17&lt;00:13, 15982.46 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  58%|█████▊    | 288794/501435 [00:17&lt;00:12, 16478.92 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  58%|█████▊    | 291000/501435 [00:18&lt;00:14, 14711.11 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  58%|█████▊    | 292753/501435 [00:18&lt;00:13, 15380.15 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  59%|█████▉    | 295134/501435 [00:18&lt;00:13, 15544.18 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  59%|█████▉    | 296792/501435 [00:18&lt;00:12, 15794.39 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  60%|█████▉    | 299103/501435 [00:18&lt;00:12, 15655.54 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  60%|██████    | 300998/501435 [00:18&lt;00:12, 16266.94 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  61%|██████    | 303429/501435 [00:18&lt;00:12, 16244.39 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  61%|██████    | 306000/501435 [00:19&lt;00:11, 16301.03 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  61%|██████▏   | 307811/501435 [00:19&lt;00:11, 16724.81 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  62%|██████▏   | 310090/501435 [00:19&lt;00:11, 16205.54 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  62%|██████▏   | 312512/501435 [00:19&lt;00:11, 16182.36 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  63%|██████▎   | 314964/501435 [00:19&lt;00:11, 16121.70 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  63%|██████▎   | 317343/501435 [00:19&lt;00:11, 16039.20 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  64%|██████▎   | 319000/501435 [00:19&lt;00:11, 15956.81 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  64%|██████▍   | 320728/501435 [00:19&lt;00:11, 16276.71 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  64%|██████▍   | 323037/501435 [00:20&lt;00:11, 15972.25 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  65%|██████▍   | 324987/501435 [00:20&lt;00:10, 16486.71 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  65%|██████▌   | 327396/501435 [00:20&lt;00:10, 16338.17 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  66%|██████▌   | 329992/501435 [00:20&lt;00:10, 16416.37 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  66%|██████▌   | 332112/501435 [00:20&lt;00:10, 15693.14 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  67%|██████▋   | 334000/501435 [00:20&lt;00:10, 15947.28 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  67%|██████▋   | 335647/501435 [00:20&lt;00:10, 16070.01 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  67%|██████▋   | 338074/501435 [00:21&lt;00:10, 16106.16 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  68%|██████▊   | 339993/501435 [00:21&lt;00:09, 16605.54 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  68%|██████▊   | 342415/501435 [00:21&lt;00:09, 16441.79 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  69%|██████▉   | 344994/501435 [00:21&lt;00:09, 16559.70 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  69%|██████▉   | 347329/501435 [00:21&lt;00:09, 16242.97 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  70%|██████▉   | 348972/501435 [00:21&lt;00:09, 16285.49 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  70%|███████   | 351307/501435 [00:21&lt;00:09, 16043.90 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  70%|███████   | 352939/501435 [00:21&lt;00:09, 16109.53 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  71%|███████   | 354573/501435 [00:22&lt;00:09, 16166.30 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  71%|███████   | 356196/501435 [00:22&lt;00:08, 16178.84 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  71%|███████▏  | 358328/501435 [00:22&lt;00:09, 14718.02 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  72%|███████▏  | 360000/501435 [00:22&lt;00:09, 15043.63 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  72%|███████▏  | 361681/501435 [00:22&lt;00:09, 15498.98 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  72%|███████▏  | 363262/501435 [00:22&lt;00:08, 15578.84 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  73%|███████▎  | 365000/501435 [00:22&lt;00:08, 15832.11 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  73%|███████▎  | 366770/501435 [00:22&lt;00:08, 16354.93 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  74%|███████▎  | 369156/501435 [00:23&lt;00:08, 16184.40 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  74%|███████▍  | 370987/501435 [00:23&lt;00:07, 16652.48 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  74%|███████▍  | 373359/501435 [00:23&lt;00:07, 16346.67 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  75%|███████▍  | 375980/501435 [00:23&lt;00:07, 16502.78 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  75%|███████▌  | 378392/501435 [00:23&lt;00:07, 16363.72 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  76%|███████▌  | 380997/501435 [00:23&lt;00:07, 16590.61 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  76%|███████▋  | 383378/501435 [00:23&lt;00:07, 16364.32 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  77%|███████▋  | 385988/501435 [00:24&lt;00:06, 16536.78 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  77%|███████▋  | 388386/501435 [00:24&lt;00:06, 16367.36 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  78%|███████▊  | 390990/501435 [00:24&lt;00:06, 16404.63 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  78%|███████▊  | 393385/501435 [00:24&lt;00:06, 16272.81 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  79%|███████▉  | 395978/501435 [00:24&lt;00:06, 16357.35 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  79%|███████▉  | 398284/501435 [00:24&lt;00:06, 16062.38 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  80%|███████▉  | 399962/501435 [00:24&lt;00:06, 16217.68 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  80%|████████  | 402327/501435 [00:25&lt;00:06, 16071.13 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  81%|████████  | 404000/501435 [00:25&lt;00:06, 15780.28 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  81%|████████  | 405627/501435 [00:25&lt;00:06, 15897.72 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  81%|████████  | 407222/501435 [00:25&lt;00:05, 15908.33 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  82%|████████▏ | 408972/501435 [00:25&lt;00:05, 16225.22 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  82%|████████▏ | 411260/501435 [00:25&lt;00:05, 15863.20 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  82%|████████▏ | 412978/501435 [00:25&lt;00:05, 15988.83 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  83%|████████▎ | 415402/501435 [00:25&lt;00:05, 16046.40 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  83%|████████▎ | 417747/501435 [00:26&lt;00:05, 15903.05 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  84%|████████▍ | 420000/501435 [00:26&lt;00:05, 15615.61 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  84%|████████▍ | 421641/501435 [00:26&lt;00:05, 15801.92 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  85%|████████▍ | 424038/501435 [00:26&lt;00:04, 15859.17 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  85%|████████▍ | 426000/501435 [00:26&lt;00:04, 16155.93 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  85%|████████▌ | 427964/501435 [00:26&lt;00:04, 16684.52 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  86%|████████▌ | 430361/501435 [00:26&lt;00:04, 16439.89 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  86%|████████▋ | 432983/501435 [00:26&lt;00:04, 16495.18 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  87%|████████▋ | 435441/501435 [00:27&lt;00:04, 16459.44 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  87%|████████▋ | 437991/501435 [00:27&lt;00:03, 16411.95 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  88%|████████▊ | 440397/501435 [00:27&lt;00:03, 16296.20 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  88%|████████▊ | 442970/501435 [00:27&lt;00:03, 16296.29 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  89%|████████▉ | 445199/501435 [00:27&lt;00:03, 15863.23 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  89%|████████▉ | 447594/501435 [00:27&lt;00:03, 15891.64 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  90%|████████▉ | 449756/501435 [00:28&lt;00:03, 14668.58 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  90%|████████▉ | 451241/501435 [00:28&lt;00:03, 14705.80 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  90%|█████████ | 452996/501435 [00:28&lt;00:03, 15367.65 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  91%|█████████ | 454595/501435 [00:28&lt;00:03, 15522.94 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  91%|█████████ | 456205/501435 [00:28&lt;00:02, 15674.09 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  91%|█████████▏| 457979/501435 [00:28&lt;00:02, 16118.41 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  92%|█████████▏| 460171/501435 [00:28&lt;00:02, 15559.24 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  92%|█████████▏| 461992/501435 [00:28&lt;00:02, 16140.62 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  93%|█████████▎| 464407/501435 [00:28&lt;00:02, 16123.38 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  93%|█████████▎| 466785/501435 [00:29&lt;00:02, 15815.81 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  94%|█████████▎| 469087/501435 [00:29&lt;00:02, 15655.29 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  94%|█████████▍| 470732/501435 [00:29&lt;00:01, 15840.20 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  94%|█████████▍| 472353/501435 [00:29&lt;00:01, 15931.96 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  95%|█████████▍| 474000/501435 [00:29&lt;00:01, 15797.42 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  95%|█████████▍| 475703/501435 [00:29&lt;00:01, 16128.68 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  95%|█████████▌| 477333/501435 [00:29&lt;00:01, 16173.36 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  96%|█████████▌| 479000/501435 [00:29&lt;00:01, 15996.04 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  96%|█████████▌| 480742/501435 [00:29&lt;00:01, 16399.43 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Map:  96%|█████████▌| 481123/501435 [00:30&lt;00:01, 15795.93 examples/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">KeyboardInterrupt</span><span class="g g-Whitespace">                         </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">18</span><span class="p">],</span> <span class="n">line</span> <span class="mi">4</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span>   <span class="n">sample</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">sample</span><span class="p">[</span><span class="s1">&#39;tokens&#39;</span><span class="p">])</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span>   <span class="k">return</span> <span class="n">sample</span>
<span class="ne">----&gt; </span><span class="mi">4</span> <span class="n">ds</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">modi</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">5</span> <span class="n">ds</span>

<span class="nn">File /opt/hostedtoolcache/Python/3.13.1/x64/lib/python3.13/site-packages/datasets/arrow_dataset.py:560,</span> in <span class="ni">transmit_format.&lt;locals&gt;.wrapper</span><span class="nt">(*args, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">553</span> <span class="n">self_format</span> <span class="o">=</span> <span class="p">{</span>
<span class="g g-Whitespace">    </span><span class="mi">554</span>     <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_format_type</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">555</span>     <span class="s2">&quot;format_kwargs&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_format_kwargs</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">556</span>     <span class="s2">&quot;columns&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_format_columns</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">557</span>     <span class="s2">&quot;output_all_columns&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_output_all_columns</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">558</span> <span class="p">}</span>
<span class="g g-Whitespace">    </span><span class="mi">559</span> <span class="c1"># apply actual function</span>
<span class="ne">--&gt; </span><span class="mi">560</span> <span class="n">out</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="s2">&quot;Dataset&quot;</span><span class="p">,</span> <span class="s2">&quot;DatasetDict&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">561</span> <span class="n">datasets</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="s2">&quot;Dataset&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">out</span><span class="o">.</span><span class="n">values</span><span class="p">())</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)</span> <span class="k">else</span> <span class="p">[</span><span class="n">out</span><span class="p">]</span>
<span class="g g-Whitespace">    </span><span class="mi">562</span> <span class="c1"># re-apply format to the output</span>

<span class="nn">File /opt/hostedtoolcache/Python/3.13.1/x64/lib/python3.13/site-packages/datasets/arrow_dataset.py:3073,</span> in <span class="ni">Dataset.map</span><span class="nt">(self, function, with_indices, with_rank, input_columns, batched, batch_size, drop_last_batch, remove_columns, keep_in_memory, load_from_cache_file, cache_file_name, writer_batch_size, features, disable_nullable, fn_kwargs, num_proc, suffix_template, new_fingerprint, desc)</span>
<span class="g g-Whitespace">   </span><span class="mi">3067</span> <span class="k">if</span> <span class="n">transformed_dataset</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">3068</span>     <span class="k">with</span> <span class="n">hf_tqdm</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">3069</span>         <span class="n">unit</span><span class="o">=</span><span class="s2">&quot; examples&quot;</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">3070</span>         <span class="n">total</span><span class="o">=</span><span class="n">pbar_total</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">3071</span>         <span class="n">desc</span><span class="o">=</span><span class="n">desc</span> <span class="ow">or</span> <span class="s2">&quot;Map&quot;</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">3072</span>     <span class="p">)</span> <span class="k">as</span> <span class="n">pbar</span><span class="p">:</span>
<span class="ne">-&gt; </span><span class="mi">3073</span>         <span class="k">for</span> <span class="n">rank</span><span class="p">,</span> <span class="n">done</span><span class="p">,</span> <span class="n">content</span> <span class="ow">in</span> <span class="n">Dataset</span><span class="o">.</span><span class="n">_map_single</span><span class="p">(</span><span class="o">**</span><span class="n">dataset_kwargs</span><span class="p">):</span>
<span class="g g-Whitespace">   </span><span class="mi">3074</span>             <span class="k">if</span> <span class="n">done</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">3075</span>                 <span class="n">shards_done</span> <span class="o">+=</span> <span class="mi">1</span>

<span class="nn">File /opt/hostedtoolcache/Python/3.13.1/x64/lib/python3.13/site-packages/datasets/arrow_dataset.py:3445,</span> in <span class="ni">Dataset._map_single</span><span class="nt">(shard, function, with_indices, with_rank, input_columns, batched, batch_size, drop_last_batch, remove_columns, keep_in_memory, cache_file_name, writer_batch_size, features, disable_nullable, fn_kwargs, new_fingerprint, rank, offset)</span>
<span class="g g-Whitespace">   </span><span class="mi">3443</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">batched</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">3444</span>     <span class="n">_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="ne">-&gt; </span><span class="mi">3445</span>     <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">example</span> <span class="ow">in</span> <span class="n">shard_iterable</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">3446</span>         <span class="n">example</span> <span class="o">=</span> <span class="n">apply_function_on_filtered_inputs</span><span class="p">(</span><span class="n">example</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="n">offset</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">3447</span>         <span class="k">if</span> <span class="n">update_data</span><span class="p">:</span>

<span class="nn">File /opt/hostedtoolcache/Python/3.13.1/x64/lib/python3.13/site-packages/datasets/arrow_dataset.py:2389,</span> in <span class="ni">Dataset.__iter__</span><span class="nt">(self)</span>
<span class="g g-Whitespace">   </span><span class="mi">2387</span> <span class="k">for</span> <span class="n">pa_subtable</span> <span class="ow">in</span> <span class="n">table_iter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="n">batch_size</span><span class="p">):</span>
<span class="g g-Whitespace">   </span><span class="mi">2388</span>     <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">pa_subtable</span><span class="o">.</span><span class="n">num_rows</span><span class="p">):</span>
<span class="ne">-&gt; </span><span class="mi">2389</span>         <span class="n">pa_subtable_ex</span> <span class="o">=</span> <span class="n">pa_subtable</span><span class="o">.</span><span class="n">slice</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">2390</span>         <span class="n">formatted_output</span> <span class="o">=</span> <span class="n">format_table</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">2391</span>             <span class="n">pa_subtable_ex</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2392</span>             <span class="mi">0</span><span class="p">,</span>
   <span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">2395</span>             <span class="n">output_all_columns</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_output_all_columns</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2396</span>         <span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">2397</span>         <span class="k">yield</span> <span class="n">formatted_output</span>

<span class="ne">KeyboardInterrupt</span>: 
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ds</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">remove_columns</span><span class="p">([</span><span class="s2">&quot;ner_tags&quot;</span><span class="p">,</span> <span class="s2">&quot;tokens&quot;</span><span class="p">])</span>
<span class="n">ds</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Dataset({
    features: [&#39;num_tokens&#39;, &#39;text&#39;],
    num_rows: 501435
})
</pre></div>
</div>
</div>
</div>
<ol class="arabic simple" start="8">
<li><p>Each modification to the dataset introduces new cache file in the cache directory, thereby increasing the disk space. The statement is</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="nb">print</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s2">&quot;~/.cache/huggingface/datasets/ai4bharat___naamapadam/&quot;</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s2">&quot;~/.cache/huggingface/datasets/ai4bharat___naamapadam/ta&quot;</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s2">&quot;~/.cache/huggingface/datasets/ai4bharat___naamapadam/ta/1.0.0/&quot;</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s2">&quot;~/.cache/huggingface/datasets/ai4bharat___naamapadam/ta/1.0.0/9d4f21ac57d11ed4f9ea64854fdc9f5618e61acc&quot;</span><span class="p">)))</span>

<span class="k">def</span><span class="w"> </span><span class="nf">get_directory_size</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
    <span class="n">total_size</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">dirpath</span><span class="p">,</span> <span class="n">dirnames</span><span class="p">,</span> <span class="n">filenames</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">walk</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">filenames</span><span class="p">:</span>
            <span class="n">fp</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dirpath</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
            <span class="c1"># Skip symbolic links</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">islink</span><span class="p">(</span><span class="n">fp</span><span class="p">):</span>
                <span class="n">total_size</span> <span class="o">+=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">getsize</span><span class="p">(</span><span class="n">fp</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">total_size</span>

<span class="n">path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s2">&quot;~/.cache/huggingface/datasets/ai4bharat___naamapadam/ta/1.0.0&quot;</span><span class="p">)</span>
<span class="n">size_in_bytes</span> <span class="o">=</span> <span class="n">get_directory_size</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
<span class="n">size_in_mb</span> <span class="o">=</span> <span class="n">size_in_bytes</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1024</span> <span class="o">*</span> <span class="mi">1024</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Directory size: </span><span class="si">{</span><span class="n">size_in_mb</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> MB&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;ta&#39;]
[&#39;1.0.0&#39;]
[&#39;9d4f21ac57d11ed4f9ea64854fdc9f5618e61acc&#39;]
[&#39;cache-08edb42976601831.arrow&#39;, &#39;cache-276b6910d3e0f022.arrow&#39;, &#39;cache-3bcf291f0fdd77f0.arrow&#39;, &#39;cache-af0655c4e265bf0e.arrow&#39;, &#39;cache-d1d2e51c76ec6b21.arrow&#39;, &#39;dataset_info.json&#39;, &#39;LICENSE&#39;, &#39;naamapadam-test.arrow&#39;, &#39;naamapadam-train.arrow&#39;, &#39;naamapadam-validation.arrow&#39;]
Directory size: 662.27 MB
</pre></div>
</div>
</div>
</div>
<ol class="arabic simple" start="9">
<li><p>Filter the dataset so that all the samples in the dataset should have at least six tokens (any symbol separated by a white space is considered a token). Enter the number of samples in the dataset after filtering. Enter the exact number. If the answer is 123456, enter it as 123456.</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">min_limit</span> <span class="o">=</span> <span class="mi">6</span>
<span class="n">fil_ds</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">example</span><span class="p">:</span> <span class="n">example</span><span class="p">[</span><span class="s1">&#39;num_tokens&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">6</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">fil_ds</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">fil_ds</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;num_tokens&#39;: 8, &#39;text&#39;: &#39;பைரவருக்கு தேய்பிறை அஷ்டமியில் விசேஷ அபிஷேக ஆராதனைகள் நடைபெறுகின்றன .&#39;}
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Dataset({
    features: [&#39;num_tokens&#39;, &#39;text&#39;],
    num_rows: 370495
})
</pre></div>
</div>
</div>
</div>
<ol class="arabic simple" start="10">
<li><p>Download all the splits of Tamil sub-dataset “inltkh.ta” of <a class="reference external" href="https://huggingface.co/datasets/ai4bharat/indic_glue">https://huggingface.co/datasets/ai4bharat/indic_glue</a> .</p></li>
</ol>
<p>Filter the dataset so that each sample contains at least six words (separated by a single white space).Then Interleave the resultant dataset with the above filtered dataset of naamapadam. Take 80% of samples from naamapadam and 20% from indic glue. Enter the number of samples after interleaving the datasets.
Note: Set the value of the seed argument to 42.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">configs</span><span class="p">(</span><span class="s2">&quot;ai4bharat/indic_glue&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Using the latest cached version of the dataset since ai4bharat/indic_glue couldn&#39;t be found on the Hugging Face Hub
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>No. of configs - 1
Names of configs - [&#39;default&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">try</span><span class="p">:</span>
    <span class="n">ds2</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">load_dataset</span><span class="p">(</span><span class="s2">&quot;ai4bharat/indic_glue&quot;</span><span class="p">,</span> <span class="s2">&quot;inltkh.ta&quot;</span><span class="p">,</span> <span class="n">split</span><span class="o">=</span><span class="s2">&quot;all&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">ds2</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
  <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ERROR: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Using the latest cached version of the dataset since ai4bharat/indic_glue couldn&#39;t be found on the Hugging Face Hub
Found the latest cached dataset configuration &#39;inltkh.ta&#39; at C:\Users\dell\.cache\huggingface\datasets\ai4bharat___indic_glue\inltkh.ta\0.0.0\6dcbebd49d6b12965d433bffcd07e9a786211703 (last modified on Thu Jan 23 21:12:24 2025).
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Dataset({
    features: [&#39;text&#39;, &#39;label&#39;],
    num_rows: 6684
})
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ds2</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;text&#39;</span><span class="p">]))</span>
<span class="n">ds2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>254
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;text&#39;: &#39;கே.வி.ஆனந்தே ட்விட்டரில் இதை அறிவித்துள்ளார். இந்தப் படத்துக்கு கேவ்மிக் ஆரி ஒளிப்பதிவு செய்ய, ஹாரிஸ் ஜெயராஜ் இசையமைக்கிறார். பட்டுக்கோட்டை பிரபாகர் வசனம் எழுத, கலை இயக்குநராக கிரண் பணியாற்றுகிறார். இந்தப் படத்தை லைகா புரொடக்\u200cஷன்ஸ் நிறுவனம் தயாரிக்கிறது.&#39;,
 &#39;label&#39;: 6}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fil_ds2</span> <span class="o">=</span> <span class="n">ds2</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">example</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">example</span><span class="p">[</span><span class="s2">&quot;text&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">))</span> <span class="o">&gt;=</span><span class="mi">6</span> <span class="p">)</span>
<span class="n">fil_ds2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Filter: 100%|██████████| 6684/6684 [00:00&lt;00:00, 110277.43 examples/s]
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Dataset({
    features: [&#39;text&#39;, &#39;label&#39;],
    num_rows: 6428
})
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">inter_ds</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">interleave_datasets</span><span class="p">([</span><span class="n">fil_ds</span><span class="p">,</span> <span class="n">fil_ds2</span><span class="p">],</span>
                                        <span class="n">probabilities</span><span class="o">=</span><span class="p">[</span><span class="mf">0.8</span><span class="p">,</span><span class="mf">0.2</span><span class="p">],</span>
                                        <span class="n">seed</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="n">inter_ds</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Dataset({
    features: [&#39;num_tokens&#39;, &#39;text&#39;, &#39;label&#39;],
    num_rows: 32354
})
</pre></div>
</div>
</div>
</div>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./notebooks"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="../README.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Deep-Learning-Practices Notes</p>
      </div>
    </a>
    <a class="right-next"
       href="DLP_Week_2.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Week 2</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Yash Mishra
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2025.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>